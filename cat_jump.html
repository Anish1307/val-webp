<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Cat Jump</title>
  <style>
    body{margin:0; height:100vh; display:grid; place-items:center; background:#111; font-family:system-ui; color:#fff; touch-action:manipulation}
    #wrap{width:min(420px,92vw); text-align:center}
    canvas{width:100%; height:auto; background:#1c1c1c; border-radius:18px; box-shadow:0 16px 40px rgba(0,0,0,.35)}
    .row{display:flex; gap:10px; justify-content:center; margin-top:10px}
    button{border:0; padding:10px 14px; border-radius:999px; font-weight:700}
  </style>
</head>
<body>
<div id="wrap">
  <h2>üêæ Cat Jump</h2>
  <canvas id="c" width="420" height="260"></canvas>
  <div class="row">
    <button id="reset">Restart</button>
    <div id="hud" style="opacity:.9; font-weight:700"></div>
  </div>
  <p style="opacity:.75; margin:10px 0 0">Tap anywhere to jump. Don‚Äôt hit the box.</p>
</div>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const hud = document.getElementById('hud');

let cat, box, score, best, running, jumpLock;
best = Number(localStorage.getItem('catjump_best') || 0);

function reset(){
  cat = {x:70, y:200, w:34, h:28, vy:0, onGround:true};
  box = {x:canvas.width+40, y:210, w:28, h:30, vx:3.2};
  score = 0; running = true; jumpLock = false;
}
reset();

function jump(){
  if(!running) return;
  if(cat.onGround){
    cat.vy = -9.6;
    cat.onGround = false;
  }
}

function collide(a,b){
  return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;
}

function drawCat(){
  // simple cat blob + ears
  ctx.fillStyle="#ffcc66";
  ctx.beginPath(); ctx.roundRect(cat.x,cat.y,cat.w,cat.h,10); ctx.fill();
  ctx.fillStyle="#ffcc66";
  ctx.beginPath();
  ctx.moveTo(cat.x+7, cat.y); ctx.lineTo(cat.x+12, cat.y-10); ctx.lineTo(cat.x+17, cat.y);
  ctx.moveTo(cat.x+cat.w-7, cat.y); ctx.lineTo(cat.x+cat.w-12, cat.y-10); ctx.lineTo(cat.x+cat.w-17, cat.y);
  ctx.fill();
  ctx.fillStyle="#111";
  ctx.fillRect(cat.x+10, cat.y+10, 4, 4);
  ctx.fillRect(cat.x+20, cat.y+10, 4, 4);
}

function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // ground
  ctx.fillStyle="#2a2a2a";
  ctx.fillRect(0,238,canvas.width,4);

  // physics
  if(running){
    cat.vy += 0.55;
    cat.y += cat.vy;
    if(cat.y >= 200){ cat.y = 200; cat.vy = 0; cat.onGround = true; }

    box.x -= box.vx;
    if(box.x < -box.w){
      box.x = canvas.width + 60;
      score++;
      box.vx = Math.min(7.2, box.vx + 0.15);
    }

    if(collide(cat, box)){
      running = false;
      best = Math.max(best, score);
      localStorage.setItem('catjump_best', best);
    }
  }

  // obstacle
  ctx.fillStyle="#7bdff2";
  ctx.beginPath(); ctx.roundRect(box.x,box.y,box.w,box.h,8); ctx.fill();

  drawCat();

  hud.textContent = `Score: ${score}  ‚Ä¢  Best: ${best}${running ? "" : "  ‚Ä¢  Tap to restart"}`;

  if(!running){
    ctx.fillStyle="rgba(0,0,0,.5)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#fff";
    ctx.font="bold 22px system-ui";
    ctx.textAlign="center";
    ctx.fillText("Boop! You got bonked üòº", canvas.width/2, 120);
    ctx.font="16px system-ui";
    ctx.fillText("Tap to try again", canvas.width/2, 150);
  }

  requestAnimationFrame(loop);
}
loop();

// input
canvas.addEventListener('pointerdown', () => { if(!running){ reset(); } else jump(); });
document.body.addEventListener('pointerdown', (e)=>{ if(e.target.tagName !== "BUTTON" && e.target !== canvas){ if(!running){ reset(); } else jump(); }});
document.getElementById('reset').addEventListener('click', reset);

// polyfill-ish for roundRect in older browsers
if(!CanvasRenderingContext2D.prototype.roundRect){
  CanvasRenderingContext2D.prototype.roundRect=function(x,y,w,h,r){
    r=Math.min(r,w/2,h/2);
    this.beginPath();
    this.moveTo(x+r,y);
    this.arcTo(x+w,y,x+w,y+h,r);
    this.arcTo(x+w,y+h,x,y+h,r);
    this.arcTo(x,y+h,x,y,r);
    this.arcTo(x,y,x+w,y,r);
    this.closePath();
    return this;
  };
}
</script>
</body>
</html>
